\chapter{Introduction}
\label{sec:introduction}


\section{Motivation}
The automotive industry is rapidly evolving over the years, since the introduction of the Ford Model T in 1917. Although the main purpose of these machines remains the same (e.g. getting someone from point A to B swiftly), the relative comfort, speed, safety, and efficiency has been improved dramatically. Primarily due to the introduction of electronic computers into the vehicle's architecture. The modern vehicle has been appropriately called a "Computer on wheels" \cite{Klinedinst05}, since each one contains up to 100 millions lines of code, spread out over tens of Electronic Control Units (ECUs) \cite{Pike15}. Each ECU is an embedded computer that is designed to perform a specific function (e.g. braking, opening the door, speed control, etc.). In addition to having this wide variety of embedded devices, a modern vehicle will also employ a data bus that allows all ECU's inside a vehicle to communicate with each other. There are multiple standards that are employed even within a single vehicle, but the CAN (Controller Area Network) protocol is the most widely used one \cite{VatiCAN}, Hence we focus on it in this paper. \\ \\ Alongside internal communication networks, many modern models of vehicles also support some way of performing external communications. This can range from vehicle-to-infrastructure (V2I) (e.g. wireless gas payment at a gas station, wireless diagnostics at a repair shop or even virtual traffic lights), vehicle-to-vehicle communications (V2V) (e.g. automatically following another vehicle), vehicle-to-network (V2N) (connecting your vehicle to an already existing network, like the cellular communications network for example) and vehicle-to-pedestrian (V2P) \cite{Kleberger15}\cite{Russel17}\cite{Ahmed}. All of the extended functionality introduced greatly improves the vehicle's flexibility, comfort and safety. This however also makes them increasingly vulnerable to a wide variety of cyber attacks through the various interfaces that can communicate with the external world, exemplified by abusing remote keyless entry (RKE) systems to gain access to a car \cite{KeeLoq}\cite{MillerA}, remotely causing a vehicle to think it is having a tire problem by interfering with the tire pressure monitoring system (TPMS) \cite{MillerA} or even compromising a vehicle through the Bluetooth interface \cite{Kosher2}\cite{Kosher}. The On-board Diagnostics (OBD-II) port is one of the potential attack vectors.  OBD-II systems are widely deployed in auto-mobiles as a way of getting diagnostics information from the vehicle. OBD-II introduces a physical interface into the vehicle (usually under the steering wheel) called the Data Link Connector (DLC). This physical interface allows full access to the internal network. It has been repeatedly shown \cite{MillerA}\cite{Yadav16}\cite{MillerB}\cite{MillerC} that a set of messages or signals could be injected on a car's CAN bus to control key components (e.g. lights, locks, brakes, and engine) as well as injecting code into key ECUs. The focus of this thesis will be to try and mitigate this kind of illegal access by introducing access control to the OBD-II interface.

\section{Challenges} \label{sec:challenges}
The main challenge of this research topic is to introduce a solution that ports well to the kind of hardware that is found in modern vehicles. Introducing new components into the internal vehicle network would surely simplify things (if this were the case the solution could consist of introducing a small component that acts as a firewall for the OBD-II interface). However this implies that any potential real-world implementation requires the installation of this component into millions of currently in-use vehicles, which (being a very costly endeavour) would deter any manufacturers from doing so. Therefore, a software-based approach is required. It is easy to deploy such a solution on the currently in-use cars without any hardware modification or excessive expenses. However, This approach introduces it's own challenges, namely the limitations of ECU micro controllers. Indeed, any solution that isn't portable to the network (because of memory limitations, limited processing power, incompatible architectures, etc.) is rendered useless. It is worth noting that the solution proposed here is not intended to (and will not) protect against attacks using other attack vectors (e.g. TPMS, Bluetooth, etc.) as well as physical attacks. Indeed any attacker gaining physical access to the vehicle has to ability to directly interface with the vehicle network (e.g. by physically tapping into the CAN bus). Typically only the owner of the vehicle has this privilege, and it is safe to assume this person is reluctant to compromise the safety of his or her own vehicle. unauthorised physical access should be mitigated by different means (e.g. car alarms, safe RKE systems, the authorities, etc.). The main challenges of this thesis paper are summarized as follows:

\begin{itemize}
	\item \textbf{portability:} The solution should port well to existing vehicle networks. 
	\item \textbf{Security:} The solution should be sufficiently secure according to current computer safety standards. 
	\item \textbf{Speed:} The solution should not impede the operation of other processes running on the same network.
\end{itemize}

\section{Context}
As mentioned before, the goal of this paper is to secure the OBD-II interface in modern cars. Before we move on it is interesting to take a look at some other issues regarding internal vehicle networks, as well as some proposed solutions to these problems. Aside from the OBD-II interface there are numerous points of entry to the internal vehicle network, both physical (Breaking into the vehicle and directly connecting to the network) or remote (Bluetooth, TPMS or Tire Pressure Monitoring System, Radio system, etc.) \cite{MillerA}. Take Bluetooth for example: many cars include Bluetooth functionality to allow users to connect their phones and play music. The Bluetooth protocol has a large protocol-stack and has been known to have problems in the past \cite{MillerA} like discoverability, bluejacking, bluesnarfing and backdoor attacks \cite{Bluetooth}. By exploiting the vulnerabilities of a car's Bluetooth interface, a malicious agent is able to interfere with the internal network remotely (using his/her mobile phone). Another problem is that it is easy for a phone to get compromised (visiting a malicious website) \cite{Yadav16}. This problem would be solved by using a more secure version that does not contain the aforementioned vulnerabilities.\newline 
\newline
Another approach is to secure the protocol that is used for communication within the network. As mentioned before, the CAN protocol is probably the most popular one since almost every new passenger car manufactured in Europe is equipped with at least one CAN network \cite{CANhistory}. CAN in itself is a simple bus protocol that allows nodes on a network to send and receive messages. However CAN is a low-level protocol and does not natively support any security features. A number of secure CAN variations have been proposed: Leia \cite{Leia}, VatiCAN \cite{VatiCAN}, VulCAN \cite{VulCAN} and CANopen \cite{Pfeiffer}.

\section{Contributions}
\label{sec:contributions}

The contribution of this thesis can be summarized as follows:

\begin{itemize}
	\item Overcoming the security limitation identified by the unauthorised access to the vehicle CAN network via the OBD-II port by designing and developing a role-based access control model based on public key cryptography.
	
	\item Advancing the security of OBD-II ports by bringing it closer to reality through a proper implementation on CAN-enabled resource-constrained ECU that is used in various automotive models. Furthermore, we evaluate and show that our approach is secure, feasible and lightweight in terms of memory footprint and runtime overhead.
\end{itemize} 